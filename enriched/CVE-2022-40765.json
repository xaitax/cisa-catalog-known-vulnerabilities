{"Modified": "2022-11-26T03:25:00", "Published": "2022-11-22T01:15:00", "access": {}, "assigner": "cve@mitre.org", "capec": [{"id": "76", "name": "Manipulating Web Input to File System Calls", "prerequisites": "Program must allow for user controlled variables to be applied directly to the filesystem", "related_weakness": ["15", "22", "23", "264", "272", "285", "346", "348", "59", "715", "73", "74", "77"], "solutions": "Design: Enforce principle of least privilege. Design: Ensure all input is validated, and does not contain file system commands Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands. Design: For interactive user applications, consider if direct file system interface is necessary, instead consider having the application proxy communication. Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.", "summary": "An attacker manipulates inputs to the target software which the target software passes to file system calls in the OS. The goal is to gain access to, and perhaps modify, areas of the file system that the target software did not intend to be accessible."}, {"id": "248", "name": "Command Injection", "prerequisites": "The target application must accept input from the user and then use this input in the construction of commands to be executed. In virtually all cases, this is some form of string input that is concatenated to a constant string defined by the application to form the full command to be executed.", "related_weakness": ["77"], "solutions": "All user-controllable input should be validated and filtered for potentially unwanted characters. Whitelisting input is desired, but if a blacklisting approach is necessary, then focusing on command related terms and delimiters is necessary. Input should be encoded prior to use in commands to make sure command related characters are not treated as part of the command. For example, quotation characters may need to be encoded so that the application does not treat the quotation as a delimiter. Input should be parameterized, or restricted to data sections of a command, thus removing the chance that the input will be treated as part of the command itself.", "summary": "An adversary looking to execute a command of their choosing, injects new items into an existing command thus modifying interpretation away from what was intended. Commands in this context are often standalone strings that are interpreted by a downstream component and cause specific responses. This type of attack is possible when untrusted values are used to build these command strings. Weaknesses in input validation or command construction can enable the attack and lead to successful exploitation."}, {"id": "75", "name": "Manipulating Writeable Configuration Files", "prerequisites": "Configuration files must be modifiable by the attacker", "related_weakness": ["346", "349", "353", "354", "713", "77", "99"], "solutions": "Design: Enforce principle of least privilege Design: Backup copies of all configuration files Implementation: Integrity monitoring for configuration files Implementation: Enforce audit logging on code and configuration promotion procedures. Implementation: Load configuration from separate process and memory space, for example a separate physical device like a CD", "summary": "Generally these are manually edited files that are not in the preview of the system administrators, any ability on the attackers' behalf to modify these files, for example in a CVS repository, gives unauthorized access directly to the application, the same as authorized users."}, {"id": "136", "name": "LDAP Injection", "prerequisites": "The target application must accept a string as user input, fail to sanitize characters that have a special meaning in LDAP queries in the user input, and insert the user-supplied string in an LDAP query which is then processed.", "related_weakness": ["20", "77", "90"], "solutions": "Strong input validation - All user-controllable input must be validated and filtered for illegal characters as well as LDAP content. Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the LDAP or application.", "summary": "An attacker manipulates or crafts an LDAP query for the purpose of undermining the security of the target. Some applications use user input to create LDAP queries that are processed by an LDAP server. For example, a user might provide their username during authentication and the username might be inserted in an LDAP query during the authentication process. An attacker could use this input to inject additional commands into an LDAP query that could disclose sensitive information. For example, entering a * in the aforementioned query might return information about all users on the system. This attack is very similar to an SQL injection attack in that it manipulates a query to gather additional information or coerce a particular return value."}, {"id": "15", "name": "Command Delimiters", "prerequisites": "Software's input validation or filtering must not detect and block presence of additional malicious command.", "related_weakness": ["138", "140", "146", "154", "157", "184", "185", "697", "713", "77", "78", "93"], "solutions": "Design: Perform whitelist validation against a positive specification for command length, type, and parameters. Design: Limit program privileges, so if commands circumvent program input validation or filter routines then commands do not running under a privileged account Implementation: Perform input validation for all remote content. Implementation: Use type conversions such as JDBC prepared statements.", "summary": "An attack of this type exploits a programs' vulnerabilities that allows an attacker's commands to be concatenated onto a legitimate command with the intent of targeting other resources such as the file system or database. The system that uses a filter or a blacklist input validation, as opposed to whitelist validation is vulnerable to an attacker who predicts delimiters (or combinations of delimiters) not present in the filter or blacklist. As with other injection attacks, the attacker uses the command delimiter payload as an entry point to tunnel through the application and activate additional attacks through SQL queries, shell commands, network scanning, and so on."}, {"id": "183", "name": "IMAP/SMTP Command Injection", "prerequisites": "The target environment must consist of a web-mail server that the attacker can query and a back-end mail server. The back-end mail server need not be directly accessible to the attacker. The web-mail server must fail to adequately sanitize fields received from users and passed on to the back-end mail server. The back-end mail server must not be adequately secured against receiving malicious commands from the web-mail server.", "related_weakness": ["77"], "solutions": "", "summary": "An attacker exploits weaknesses in input validation on IMAP/SMTP servers to execute commands on the server. Web-mail servers often sit between the Internet and the IMAP or SMTP mail server. User requests are received by the web-mail servers which then query the back-end mail server for the requested information and return this response to the user. In an IMAP/SMTP command injection attack, mail-server commands are embedded in parts of the request sent to the web-mail server. If the web-mail server fails to adequately sanitize these requests, these commands are then sent to the back-end mail server when it is queried by the web-mail server, where the commands are then executed. This attack can be especially dangerous since administrators may assume that the back-end server is protected against direct Internet access and therefore may not secure it adequately against the execution of malicious commands."}, {"id": "40", "name": "Manipulating Writeable Terminal Devices", "prerequisites": "User terminals must have a permissive access control such as world writeable that allows normal users to control data on other user's terminals.", "related_weakness": ["77"], "solutions": "Design: Ensure that terminals are only writeable by named owner user and/or administrator Design: Enforce principle of least privilege", "summary": "This attack exploits terminal devices that allow themselves to be written to by other users. The attacker sends command strings to the target terminal device hoping that the target user will hit enter and thereby execute the malicious command with their privileges. The attacker can send the results (such as copying /etc/passwd) to a known directory and collect once the attack has succeeded."}, {"id": "43", "name": "Exploiting Multiple Input Interpretation Layers", "prerequisites": "User input is used to construct a command to be executed on the target system or as part of the file name. Multiple parser passes are performed on the data supplied by the user.", "related_weakness": ["171", "179", "181", "183", "184", "20", "697", "707", "74", "77", "78"], "solutions": "An iterative approach to input validation may be required to ensure that no dangerous characters are present. It may be necessary to implement redundant checking across different input validation layers. Ensure that invalid data is rejected as soon as possible and do not continue to work with it. Make sure to perform input validation on canonicalized data (i.e. data that is data in its most standard form). This will help avoid tricky encodings getting past the filters. Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system.", "summary": "An attacker supplies the target software with input data that contains sequences of special characters designed to bypass input validation logic. This exploit relies on the target making multiples passes over the input data and processing a \"layer\" of special characters with each pass. In this manner, the attacker can disguise input that would otherwise be rejected as invalid by concealing it with layers of special/escape characters that are stripped off by subsequent processing steps. The goal is to first discover cases where the input validation layer executes before one or more parsing layers. That is, user input may go through the following logic in an application: <parser1> --> <input validator> --> <parser2>. In such cases, the attacker will need to provide input that will pass through the input validator, but after passing through parser2, will be converted into something that the input validator was supposed to stop."}], "cvss": null, "cwe": "CWE-77", "id": "CVE-2022-40765", "impact": {}, "last-modified": "2022-11-26T03:25:00", "references": ["https://www.mitel.com/support/security-advisories", "https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-22-0007"], "summary": "A vulnerability in the Edge Gateway component of Mitel MiVoice Connect through 19.3 (22.22.6100.0) could allow an authenticated attacker with internal network access to conduct a command-injection attack, due to insufficient restriction of URL parameters.", "vulnerable_configuration": [{"id": "cpe:2.3:a:mitel:mivoice_connect:-:*:*:*:*:*:*:*", "title": "cpe:2.3:a:mitel:mivoice_connect:-:*:*:*:*:*:*:*"}, {"id": "cpe:2.3:a:mitel:mivoice_connect:19.1:*:*:*:*:*:*:*", "title": "cpe:2.3:a:mitel:mivoice_connect:19.1:*:*:*:*:*:*:*"}, {"id": "cpe:2.3:a:mitel:mivoice_connect:19.3:-:*:*:*:*:*:*", "title": "cpe:2.3:a:mitel:mivoice_connect:19.3:-:*:*:*:*:*:*"}], "vulnerable_configuration_cpe_2_2": [], "vulnerable_product": ["cpe:2.3:a:mitel:mivoice_connect:-:*:*:*:*:*:*:*", "cpe:2.3:a:mitel:mivoice_connect:19.1:*:*:*:*:*:*:*", "cpe:2.3:a:mitel:mivoice_connect:19.3:-:*:*:*:*:*:*"]}